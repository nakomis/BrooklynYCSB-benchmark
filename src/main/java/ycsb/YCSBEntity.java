package ycsb;

import brooklyn.config.ConfigKey;
import brooklyn.entity.annotation.Effector;
import brooklyn.entity.annotation.EffectorParam;
import brooklyn.entity.basic.ConfigKeys;
import brooklyn.entity.basic.MethodEffector;
import brooklyn.entity.effector.Effectors;
import brooklyn.entity.java.VanillaJavaApp;
import brooklyn.entity.proxying.ImplementedBy;
import brooklyn.event.AttributeSensor;
import brooklyn.event.basic.BasicAttributeSensorAndConfigKey;
import brooklyn.event.basic.BasicConfigKey;
import brooklyn.event.basic.Sensors;
import com.google.common.collect.Lists;

import java.util.List;

@ImplementedBy(YCSBEntityImpl.class)
public interface YCSBEntity extends VanillaJavaApp {


    ConfigKey<List> HOSTNAMES = new BasicConfigKey<List>(List.class, "ycsb.hostnames", "list of all hostnames to benchmark", Lists.newArrayList());
    AttributeSensor<Integer> INSERT_START = Sensors.newIntegerSensor("ycsb.insertstart","inital records number to start loading");
    AttributeSensor<Integer> INSERT_COUNT = Sensors.newIntegerSensor("ycsb.insertcount","number of records the ycsb client is responsible for inserting");
    AttributeSensor<Integer> RECORD_COUNT = Sensors.newIntegerSensor("ycsb.recordcount","the total number of records");
    AttributeSensor<Integer> OPERATIONS_COUNT = Sensors.newIntegerSensor("ycsb.operationcount", "the number of operations to to run on a database");
    ConfigKey<Boolean> TIMESERIES = ConfigKeys.newBooleanConfigKey("ycsb.timeseries", "flag to specify if timeseries to be calculated in results");
    ConfigKey<Integer> TIMESERIES_GRANULARITY = ConfigKeys.newIntegerConfigKey("ycsb.timseries.granularity", "time for intervals between timeseries averages");

    Integer getInsertStart();

    Integer getRecordCount();
    @Effector(description="Loads a new workload to the database")
    void loadWorkloadEffector(@EffectorParam(name="workload", description="The name of the workload file") String workload);
    @Effector(description="Runs a workload on the database")
    void runWorkloadEffector(@EffectorParam(name="workload", description="The name of the workload file") String workload);

    @Effector(description="fetches the output files generated by YCSB to a local directory")
    void fetchOutputs(@EffectorParam(name="localpath") String localpath, @EffectorParam(name="workload") String workload);

    MethodEffector<Void> LOAD_WORKLOAD = new MethodEffector<Void>(YCSBEntity.class,"loadWorkloadEffector");
    MethodEffector<Void> RUN_WORKLOAD = new MethodEffector<Void>(YCSBEntity.class,"runWorkloadEffector");
    MethodEffector<Void> FETCH_OUTPUTS = new MethodEffector<Void>(YCSBEntity.class,"fetchOutputs");

}
