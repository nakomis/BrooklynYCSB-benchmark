package ycsb;

import brooklyn.config.ConfigKey;
import brooklyn.entity.Entity;
import brooklyn.entity.annotation.Effector;
import brooklyn.entity.annotation.EffectorParam;
import brooklyn.entity.basic.ConfigKeys;
import brooklyn.entity.group.DynamicCluster;
import brooklyn.entity.proxying.ImplementedBy;
import brooklyn.event.AttributeSensor;
import brooklyn.event.basic.Sensors;
import com.google.common.reflect.TypeToken;

import java.util.Collection;
import java.util.List;

/**
 * Created by zaid.mohsin on 16/12/2013.
 */
@ImplementedBy(YCSBEntityClusterImpl.class)
public interface YCSBEntityCluster extends DynamicCluster {


    ConfigKey<Integer> NO_OF_RECORDS = ConfigKeys.newIntegerConfigKey("ycsbcluster.noOfRecords");
    AttributeSensor<List<String>> YCSB_CLUSTER_NODES = Sensors.newSensor(new TypeToken<List<String>>() {},
            "ycsbcluster.nodes", "List of hosts of all active ycsb nodes in the cluster (public hostname/IP)");

    ConfigKey<String> LOCAL_OUTPUT_PATH = ConfigKeys.newStringConfigKey("ycsbcluster.localOutputPath","the path to fetch the output files to");
    ConfigKey<Integer> TOTAL_OPERATIONS_COUNT = ConfigKeys.newIntegerConfigKey("ycsbcluster.total.operations.count","The total number of operations to benchmark the database");

    @Override
    void setMembers(Collection<Entity> m);

    @Effector(description = "Load Workload in all YCSB clients")
    public void loadWorkloadForAll(@EffectorParam(name = "workload name") String workload);

    @Effector(description = "Run Workload in all YCSB clients")
    public void runWorkloadForAll(@EffectorParam(name = "workload name") String workload);

    @Effector(description = "Fetch the all output files generated by the tests")
    public void fetchOutputs();
}
